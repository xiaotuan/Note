###### 二十三、DNS解析安全问题

**1、DNS劫持**

一种可能的域名劫持方式即黑客侵入了宽带路由器并对终端用户的本地DNS服务器进行篡改，指向黑客自己伪造的本地DNS服务器，进而通过控制本地DNS服务器的逻辑返回错误的IP信息进行域名劫持。

另一方面，由于DNS解析主要是基于UDP协议，除了上述攻击行为外，攻击者还可以监听终端用户的域名解析请求，并在本地DNS服务器返回正确结果之前将伪造的DNS解析响应传递给终端用户，进而控制终端用户的域名访问行为。

**2、缓存污染（DNS污染）。**

我们知道在接收到域名解析请求时，本地DNS服务器首先会查找缓存，如果缓存命中就会直接返回缓存结果，不再进行递归DNS查询。这时候如果本地DNS服务器针对部分域名的缓存进行更改，比如将缓存结果指向第三方的广告页，就会导致用户的访问请求被引导到这些广告页地址上。

**3、如何解决DNS劫持？**

DNS解析发生在HTTP协议之前，DNS解析和DNS劫持和HTTP没有关系，DNS协议使用的是UDP协议向服务器的53端口进行请求。
要想解决DNS劫持：

* 可以使用HttpDNS的方案：**使用 HTTP协议向DNS服务器的80端口进行请求**,来规避DNS劫持
比如：`http://119.29.29.29/d?dn=domain&ip=clientIp`

* 在终端上，可以更换DNS服务器，不管手机还是电脑，都能手动配置DNS