[toc]

### 1. 用户账户修改工具

| 命令     | 描述                                                   |
| -------- | ------------------------------------------------------ |
| usermod  | 修改用户账户的字段，还可以指定主要组以及附加组所属关系 |
| passwd   | 修改已有用户的密码                                     |
| chpasswd | 从文件中读取登录名密码对，并更新密码                   |
| chage    | 修改密码的过期日期                                     |
| chfn     | 修改用户账户备注信息                                   |
| chsh     | 修改用户账户的默认登录 shell                           |

### 2. 使用 usermod 命令修改用户信息

`usermod` 命令能用来修改 `/etc/passwd` 文件中的大部分字段，只需用与想修改的字段对应的命令行参数就可以了。参数大部分跟 [useradd](./添加新用户.md) 命令的参数一样。除此之外，还有另外一些可能派上用场的选项：

+ `-l` 修改用户账户的登录名
+ `-L` 锁定账户，使用户无法登录
+ `-p` 修改账户的密码
+ `-U` 解除锁定，使用户能够登录

> 注意：如果更改了已登录系统账户所属的用户组，该用户必须登出系统后再登录，组关系的更改才能生效。

> 警告：为用户账户分配组时要格外小心。如果加了 `-g` 选项，指定的组名会替换掉该账户的默认组。`-G`选项将该组添加到用户的数组列表里，不会影响默认组。

### 3. 使用 passwd 和 chpasswd 命令修改用户密码

passwd 命令用于修改用户密码：

```shell
$ sudo passwd test
新的 密码： 
重新输入新的 密码： 
passwd：已成功更新密码
```

如果只用 `passwd` 命令，它会改变你自己的密码。系统上的任何用户都能改自己的密码，但只有 root 用户才有权限该别人的密码。

`-e` 选项能强制用户下次登录时修改密码。你可以先给用户设置一个简单的密码，之后再强制在下次登录时改成他们能记住的更复杂的密码。

如果需要为系统中的大量用户修改密码，`chpasswd` 命令能从标准输入自动读取登录名和密码对（由冒号分割）列表，给密码加密，然后为用户账户设置。你也可以重定向命令将含有 `userid:passwd` 对的文件重定向给该命令。

```shell
$ sudo chpasswd < users.txt
```

### 3. 使用 chsh 命令修改用户默认登录 shell

`chsh` 命令用来快速修改默认的用户登录 shell。使用时必须用 shell 的全路径名作为参数，不能只用 shell 名。

```shell
$ sudo chsh -s /bin/csh test
```

### 4. 修改用户备注信息

`chfn` 命令提供了在 `/etc/passwd` 文件的备注字段中存储信息的标志方法。`chfn` 命令会将用于 Unix 的 `finger` 命令的信息存进备注字段，而不是简单地存入一些随机文本，或者将备注字段留空。`finger` 命令可以非常方便地查看 Linux 系统上的用户信息：

```shell
$ finger test
Login: test           			Name: 
Directory: /home/test               	Shell: /bin/bash
Never logged in.
No mail.
No Plan.
```

> 说明：出于安全考虑，很多 Linux 系统管理员会在系统上禁用 `finger` 命令，不少 Linux 发行版甚至都没有默认安装该命令。

如果在使用 `chfn` 命令时没有参数，它会向你询问要将哪些适合的内容加进备注字段：

```shell
g$ sudo chfn test
正在改变 test 的用户信息
请输入新值，或直接敲回车键以使用默认值
	全名 []: Qin Tuanye
	房间号码 []: 404
	工作电话 []: 18078274565
	家庭电话 []: 0755-6547323
	其它 []: None
$ finger test
Login: test           			Name: Qin Tuanye
Directory: /home/test               	Shell: /bin/bash
Office: 404, +1-807-827-4565		Home Phone: 0755-6547323
Never logged in.
No mail.
No Plan.
```

### 5. 修改账户过期日期

`chage` 命令用来帮助管理用户账户的有效期。你需要对每个值设置多个参数：

<center><b>chage 命令参数</b></center>

| 参数 | 描述                           |
| ---- | ------------------------------ |
| -d   | 设置上次修改密码到现在的天数   |
| -E   | 设置密码过期的日期             |
| -r   | 设置密码过期到锁定账户的天数   |
| -m   | 设置修改密码之间最少要多少天   |
| -W   | 设置密码过期前多久开始提醒信息 |

`chage` 命令的日期值可以用下面两种方式中的任意一种：

+ YYYY-MM-DD 格式的日期	
+ 代表从 1970 年 1 月 1 日起到该日期天数的数值

