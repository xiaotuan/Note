[toc]

### 1. 检查 emacs 软件包

很多发行版默认并没有安装 `emacs`。你可以像下面这样使用 `which` 和 / 或 `yum list` 命令检查一下自己所用的基于 Red Hat 的发行版。

```shell
$ which emacs
/usr/bin/which: no emacs in (/usr/lib64/qt3.3/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/Christine/bin)
$
$ yum list emacs
[...]
Available Packages
emacs.x86_64		1:23.1-25.e16		base
```

对于基于 Debian 的发行版，可以使用 which 和 / 或 apt-cache show 命令来检查 emacs 编辑器软件包的安装情况，在 Ubuntu 发行版中的演示如下：

```shell
$ which emacs
$
$ sudo apt-cache show emacs
Package: emacs
Priority: optional
Section: editors
Installed-Size: 25
[...]
```

### 2. 安装 emacs

在 Ubuntu 上安装 emacs 编辑器：

```shell
$ sudo apt-get install emacs
Reading package lists... Done
Building dependency tree
[...]
$
$ which emacs
/usr/bin/emacs
```

在 CentOS 发行版而言，可以使用 yum 安装命令来安装 emacs 编辑器：

```shell
$ sudo yum install emacs
[sudo] password for Christine:
[...]
```

### 3. 在控制台中使用 emacs

在大多数终端仿真器中，`Meta` 键被映射到了 <kbd>Alt</kbd> 键。emacs 官方文档将 <kbd>Ctrl</kbd> 键缩写为 `C-`，而 Meta 键缩写为 `M-`。所以，如果你要输入 <kbd>Ctrl</kbd> + <kbd>X</kbd> 组合键，文档会显示成 `C-x`。

#### 3.1 emacs 基础

要在命令行用 `emacs` 编辑文件，输入：

```shell
$ emacs myprog.c
```

> 提示：要想在图形化桌面环境中使用控制台模式的 `emacs`，可以使用 `emacs -nw` 命令。

#### 3.2  emacs 命令

如果 `emacs` 正确地检测到了你的终端仿真器，可以使用方向键和 PageUp 以及 PageDown 键在缓冲区域移动光标。如果未能正确检测，有一些命令可用来移动光标。

+ `C-p`：上移一行（文本中的前一行）。
+ `C-b`：左移一字符。
+ `C-f`：右移一字符。
+ `C-n`：下移一行（文本中的下一行）。

还有一些命令能够让光标中进行较长距离的跳跃。

+ `M-f`：右移到下个单词。
+ `M-b`：左移到上个单词。
+ `C-a`：移至行首。
+ `C-e`：移至行尾。
+ `M-a`：移至当前句首。
+ `M-e`：移至当前句尾。
+ `M-v`：上翻一屏。
+ `C-v`：下翻一屏。
+ `M-<`：移至文本的首行。
+ `M->`：移至文本的尾行。

还有几个命令可以将编辑器缓冲区保持至文件并退出 `emacs`。

+ `C-x C-s`：保存当前缓冲区到文件。
+ `C-z`：退出 emacs 并保持在这个会话中继续运行，以便你切回。
+ `C-x C-c`：退出 emacs 并停止该程序。

你会注意到这些功能中有两个需要两次键命令。`C-x` 命令叫作**扩展命令**。

#### 3.3 编辑数据

`emacs` 编辑器在插入和删除缓冲区中的文本时非常强大。要插入文本，只需将光标移动到想插入文本的位置就可以开始输入了。要想删除文本，`emacs` 使用退格键删除光标当前所在位置之前的字符，使用删除键来删除光标当前位置之后的字符。

`emacs` 编辑器还有剪切文本的命令。删除文本和剪切文本的差别在于：当你剪切文本时，`emacs` 会将其放在一个临时区域，你可以取回；而删除的文本则会永远消失。

有几个命令可用来剪切缓冲区中的文本：

+ `M-Backspace`：剪切光标当前所在位置之前的单词。
+ `M-d`：剪切光标当前所在位置之后的单词。
+ `C-k`：剪切光标当前所在位置至行尾的文本。
+ `M-k`：剪切光标当前所在位置至句尾的文本。

`emacs` 编辑器还包括了一种独特的块剪切的方法。移动光标到待剪切区域的起始位置并按下 `C-@` 或 `C-Spacebar` 键，然后移动光标到待剪切区域的结束位置并按下 `C-w` 命令键。这两个位置之间的文本都将被剪切。

如果你在剪切文本时不巧弄错了，使用 `C-/` 命令就能撤销剪切命令，返回到剪切前的状态。

#### 3.4 复制和粘贴

当你用剪切命令剪切了某个数据后，将光标移动到你要粘贴数据的位置，用 `C-y` 来粘贴。这会将文本从临时区域取出并将其粘贴在光标所在的位置。`C-y` 命令会取出最后一个剪切命令存在的文本。如果你执行了多个剪切命令，可以用 `M-y` 命令来循环选择它们。

要复制文本，只需将它粘贴到剪切它的地方然后移动到新的位置并再使用一次 `C-y` 命令即可。如果需要，你可以粘贴文本任意多次。

#### 3.5 查找和替换

在 `emacs` 编辑器中查找文本可用 `C-s` 和 `C-r` 命令。`C-s` 命令是在会从缓冲区域中从光标当前位置到缓冲区尾部执行前向查找，而 `C-r` 命令会是冲在缓冲区域中从光标当前所在位置到缓冲区头部执行后向查找。

当输入 `C-s` 和 `C-r` 两者中的任意一个时，底行会出现一个提示，询问要查找的文本。`emacs` 可以执行两种类型的查找。

在**渐进式**查找中，`emacs` 编辑器在你键入单词时以实时方式执行文本查找。当键入第一个字母时，它会高亮显示缓冲区中所有该字母出现的地方。当键入第二个字母时，它会高亮显示文本中所有出现这两个字母组合的地方。如此往复，直到输入完要查找的文本。

在**非渐进式**查找中，在 `C-s` 或 `C-r` 命令后按下回车键。这会将查询锁定在底行区域，允许你在查找前输入完整的待查找文本。

要用心字符串来替换一个已有文本字符串，就必须用 `M-x` 命令。这个命令需要一个文本命令和参数。

该文本命令是 `replace-string`。输入该命令并按下回车键，`emacs` 会询问用来替换的新的字符串。

#### 3.6 在 emacs 中使用缓冲区

当你处于 emacs 中时，可以使用 `C-x C-f` 组合键将新的文件加载到缓冲区。这是 emacs 的查找文件模式。它会把你带到窗口的底行，允许你输入要开始编辑的文件名。如果不知道文件的名称或位置，可以按下回车键。它会在编辑窗口启动一个文件浏览器。

你可以在这里浏览到要编辑的文件。要进入上一级目录，移动到双点条目并按下回车键。要进入下一级目录，移动到该目录条目并按下回车键。如果找到了要编辑的文件，按下回车键，emacs 会自动将它加载到新的缓冲区域。

你可以按下 `C-x C-b` 扩展命令组合来列出工作缓冲区。`emacs` 编辑器拆分编辑器窗口，在底部窗口显示一个缓冲区列表。除了主要的编辑缓冲区，`emacs` 还提供了另外两个缓冲区：

+ 草稿区域，称为 \*scatch\*;
+ 消息区域，称为 \*Messages*。

有两种方式可在窗口中切换到不同的缓冲区域。

+ `C-x o`：切换到缓冲区列表窗口。用方向键移动到你想要的缓冲区域并按下回车键。
+ `C-x b`：输入你要切换到缓冲区域的名字。

#### 3.7 在控制台模式的 emacs 中使用窗口

可以用下面两个命令将 emacs 编辑窗口拆分成多个窗口。

+ `C-x 2`：将窗口水平拆分成两个窗口。
+ `C-x 3`：将窗口竖向拆分成两个窗口。

要从一个窗口移动到另一个，可用 `C-x o` 命令。注意，在创建一个新窗口时，`emacs` 会在新窗口中使用原始窗口的缓冲区域。一旦移动了新窗口，你可以在新窗口中用 `C-x C-f` 命令来加载一个新文件，或者用其中一个命令切换到一个不同的缓冲区域。

要关闭窗口，移动到该窗口并用 `C-x 0`（数字 0）命令；如果你想关掉除了你所在窗口之外的所有窗口，用 `C-x 1` （数字 1）命令。
