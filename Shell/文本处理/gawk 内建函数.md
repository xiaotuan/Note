[toc]

### 1. 数学函数

| 函数        | 描述                                |
| ----------- | ----------------------------------- |
| atan2(x, y) | x / y 的反正切，x 和 y 以弧度为单位 |
| cos(x)      | x 的余弦，x 以弧度为单位            |
| exp(x)      | x 的指数函数                        |
| int(x)      | x 的整数部分，取靠近零一侧的值      |
| log(x)      | x 的自然对数                        |
| rand()      | 比 0 大比 1 小的随机浮点值          |
| sin(x)      | x 的正弦，x 以弧度为单位            |
| sqrt(x)     | x 的平方根                          |
| srand(x)    | 为计算随机数指定一个种子值          |

在使用一些数学函数时要小心，因为 `gawk` 语言对于它能够处理的数值有一个限定区间。如果超出了这个区间，就会得到一条错误消息。

```shell
$ gawk 'BEGIN { x = exp(100); print x}'
26881171418161356094253400435962903554686976
$ gawk 'BEGIN { x = exp(1000); print x}'
gawk: 命令行:1: 警告: exp: 参数 1000 超出范围
inf
```

除了标准数学函数外，`gawk` 还支持一些按位操作数据的函数。

+ `and(v1, v2)`：执行值 v1 和 v2 的按位与运算。
+ `comp1(val)`：执行 val 的补运算。
+ `lshift(val, count)`：将值 val 左移 count 位。
+ `or(v1, v2)`：执行值 v1 和 v2 的按位或运算。
+ `rshift(val, count)`： 将值 val 右移 count 位。
+ `xor(v1, v2)`：执行值 v1 和 v2 的按位异或运算。

### 2. 字符串函数

| 函数                       | 描述                                                         |
| -------------------------- | ------------------------------------------------------------ |
| asort(s [, d])             | 将数组 s 按数据元素值排序。索引值会被替换成表示新的排序顺序的连续数字。另外，如果指定了 d，则排序后的数组会存储在数组 d 中 |
| asorti(s [, d])            | 将数组 s 按索引值排序。生成的数组会将索引值作为数据元素值，用连续数字索引来表明排序顺序。另外如果指定了 d，排序后的数组会存储在数组 d 中 |
| gensub(r, s, h [, t])      | 查找变量 $0 或目标字符串 t（如果提供了的话）来匹配正则表达式 r。如果 h 是一个以 g 或 G 开头的字符串，就用 s 替换掉匹配的字符。如果 h 是一个数字，它表示要替换掉第 h 处 r 匹配的地方 |
| gsub(r, s [, t])           | 查找变量 $0 或目标字符串 t （如果提供了的话）来匹配正则表达式 r。如果找到了，就全部替换成字符串。 |
| index(s, t)                | 返回字符串 t 在字符串 s 中的索引值，如果没有找到的话返回 0   |
| length([s])                | 返回字符串 s 的长度；如果没有指定的话，返回 $0 的长度        |
| match(s, r [, a])          | 返回字符串 s 中正则表达式 r 出现位置的索引。如果指定了数组 a，它会存储 s 中匹配正则表达式的那部分。 |
| split(s, a [, r])          | 将 s 用 FS 字符或正则表达式 x （如果指定了的话）分开放到数组 a 中。返回字段的总数 |
| sprintf(format, variables) | 用提供的 format 和 variables 返回一个类似于 printf 输出的字符串 |
| sub(r, s [, t])            | 在变量 $0 或目标字符串 t 中查找正则表达式 r 的匹配。如果找到了，就用字符串 s 替换掉第一处匹配。 |
| substr(s, i [, n])         | 返回 s 中从索引值 i 开始的 n 个字符组成的子字符串。如果未提供 n，则返回 s 剩下的部分。 |
| tolower(s)                 | 将 s 中的所有字符转换成小写                                  |
| toupper(s)                 | 将 s 中的所有字符转换成大写                                  |

```shell
$ gawk 'BEGIN { var["a"] = 1; var["g"] = 2; var["m"] = 3; var["u"] = 4; asort(var, test); for (i in test) print "Index: ", i, " - Value: ", test[i]; }'
Index:  1  - Value:  1
Index:  2  - Value:  2
Index:  3  - Value:  3
Index:  4  - Value:  4
```

### 3. 时间函数

| 函数                           | 描述                                                         |
| ------------------------------ | ------------------------------------------------------------ |
| mktime(datespec)               | 将一个按 YYYY MM DD HH SS [DST] 格式指定的日期转换成时间戳值 |
| strftime(format [, timestamp]) | 将当前时间的时间戳或 timestemp（如果提供了的话）转化格式化日期（采用 shell 函数 date() 的格式） |
| system()                       | 返回当前时间的时间戳                                         |

```shell
$ gawk 'BEGIN { date = systime(); day = strftime("%A, %B, %d, %Y", date); print day }'
Monday, September, 19, 2022
```

