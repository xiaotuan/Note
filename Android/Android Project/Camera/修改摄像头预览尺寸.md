[toc]

### 1. 微步

#### 1. 展讯平台

修改 `vendor/sprd/modules/libcamera/hal3_2v6/SprdCamera3Setting.cpp` 文件，在 `stream_info` 变量中添加要添加的预览尺寸，也可以删除要删除的预览尺寸：

```c
// we have default min_duration and stall_duration here and
// initStaticParametersforScalerInfo may be change min_duration and
// stall_duration
const cam_stream_info_t stream_info[] = {
    {{9216, 6912}, 41666666L, 41666666L}, /* 64M */
    {{6528, 4896}, 41666666L, 41666666L},
    {{5312, 3984}, 41666666L, 41666666L},
    {{5312, 2988}, 41666666L, 41666666L},
    {{5312, 2656}, 41666666L, 41666666L},
    {{5312, 2512}, 41666666L, 41666666L},
    {{5120, 3840}, 41666666L, 41666666L},
    {{5120, 2880}, 41666666L, 41666666L},
    {{5120, 2560}, 41666666L, 41666666L},
    {{5120, 2424}, 41666666L, 41666666L},
    {{4608, 3456}, 33331760L, 33331760L},
    {{4608, 2592}, 33331760L, 33331760L},
    {{4608, 2304}, 33331760L, 33331760L},
    {{4608, 2184}, 33331760L, 33331760L},
    {{4160, 3120}, 33331760L, 33331760L},
    {{4160, 2340}, 33331760L, 33331760L},
    {{4160, 2080}, 33331760L, 33331760L},
    {{4160, 1968}, 33331760L, 33331760L},
    {{4000, 3000}, 33331760L, 33331760L},
    {{4000, 2250}, 33331760L, 33331760L},
    {{4000, 2000}, 33331760L, 33331760L},
    {{4000, 1896}, 33331760L, 33331760L},
    {{3840, 2160}, 33331760L, 33331760L},
    {{3264, 2448}, 33331760L, 33331760L},
    {{3264, 1836}, 33331760L, 33331760L},
    {{3264, 1632}, 33331760L, 33331760L},
    {{3264, 1552}, 33331760L, 33331760L},
    {{2592, 1944}, 33331760L, 33331760L},
    {{2592, 1458}, 33331760L, 33331760L},
    {{2592, 1296}, 33331760L, 33331760L},
    {{2592, 1224}, 33331760L, 33331760L},
    {{2560, 1920}, 33331760L, 33331760L},
    {{2560, 1440}, 33331760L, 33331760L},
    {{2448, 2448}, 33331760L, 33331760L},
    {{2320, 1740}, 33331760L, 33331760L},
    {{2304, 1728}, 33331760L, 33331760L}, // L5Pro,4in1 binning size
    {{2272, 1080}, 33331760L, 33331760L},
    {{2160, 1080}, 33331760L, 33331760L},
    {{2048, 1536}, 33331760L, 33331760L},
    {{2048, 1152}, 33331760L, 33331760L},
    {{1920, HEIGHT_2M}, 33331760L, 33331760L},
    {{1600, 1200}, 33331760L, 33331760L},
    {{1440, 1080}, 33331760L, 33331760L},
    {{1280, 720}, 33331760L, 33331760L},
    {{960, 720}, 33331760L, 33331760L},
    {{800, 600}, 33331760L, 33331760L},
    {{720, 480}, 33331760L, 33331760L},
    {{640, 480}, 33331760L, 33331760L},
    {{352, 288}, 33331760L, 33331760L},
    {{320, 240}, 33331760L, 33331760L},
    {{176, 144}, 33331760L, 33331760L}};
```

比如要添加 `1920 x 1200` 的预览尺寸，可以类似代码如下添加：

```c
// we have default min_duration and stall_duration here and
// initStaticParametersforScalerInfo may be change min_duration and
// stall_duration
const cam_stream_info_t stream_info[] = {
    {{9216, 6912}, 41666666L, 41666666L}, /* 64M */
    {{6528, 4896}, 41666666L, 41666666L},
    {{5312, 3984}, 41666666L, 41666666L},
    {{5312, 2988}, 41666666L, 41666666L},
    {{5312, 2656}, 41666666L, 41666666L},
    {{5312, 2512}, 41666666L, 41666666L},
    {{5120, 3840}, 41666666L, 41666666L},
    {{5120, 2880}, 41666666L, 41666666L},
    {{5120, 2560}, 41666666L, 41666666L},
    {{5120, 2424}, 41666666L, 41666666L},
    {{4608, 3456}, 33331760L, 33331760L},
    {{4608, 2592}, 33331760L, 33331760L},
    {{4608, 2304}, 33331760L, 33331760L},
    {{4608, 2184}, 33331760L, 33331760L},
    {{4160, 3120}, 33331760L, 33331760L},
    {{4160, 2340}, 33331760L, 33331760L},
    {{4160, 2080}, 33331760L, 33331760L},
    {{4160, 1968}, 33331760L, 33331760L},
    {{4000, 3000}, 33331760L, 33331760L},
    {{4000, 2250}, 33331760L, 33331760L},
    {{4000, 2000}, 33331760L, 33331760L},
    {{4000, 1896}, 33331760L, 33331760L},
    {{3840, 2160}, 33331760L, 33331760L},
    {{3264, 2448}, 33331760L, 33331760L},
    {{3264, 1836}, 33331760L, 33331760L},
    {{3264, 1632}, 33331760L, 33331760L},
    {{3264, 1552}, 33331760L, 33331760L},
    {{2592, 1944}, 33331760L, 33331760L},
    {{2592, 1458}, 33331760L, 33331760L},
    {{2592, 1296}, 33331760L, 33331760L},
    {{2592, 1224}, 33331760L, 33331760L},
    {{2560, 1920}, 33331760L, 33331760L},
    {{2560, 1440}, 33331760L, 33331760L},
    {{2448, 2448}, 33331760L, 33331760L},
    {{2320, 1740}, 33331760L, 33331760L},
    {{2304, 1728}, 33331760L, 33331760L}, // L5Pro,4in1 binning size
    {{2272, 1080}, 33331760L, 33331760L},
    {{2160, 1080}, 33331760L, 33331760L},
    {{2048, 1536}, 33331760L, 33331760L},
    {{2048, 1152}, 33331760L, 33331760L},
    {{1920, 1200}, 33331760L, 33331760L},
    {{1920, HEIGHT_2M}, 33331760L, 33331760L},
    {{1600, 1200}, 33331760L, 33331760L},
    {{1440, 1080}, 33331760L, 33331760L},
    {{1280, 720}, 33331760L, 33331760L},
    {{960, 720}, 33331760L, 33331760L},
    {{800, 600}, 33331760L, 33331760L},
    {{720, 480}, 33331760L, 33331760L},
    {{640, 480}, 33331760L, 33331760L},
    {{352, 288}, 33331760L, 33331760L},
    {{320, 240}, 33331760L, 33331760L},
    {{176, 144}, 33331760L, 33331760L}};
```

如果要修改的是前摄像头的预览尺寸，请修改该文件中 `subSensor_stream_info` 变量的值：

```c
const cam_stream_info_t subSensor_stream_info[] = {
    {{4672, 3504}, 33331760L, 33331760L},
    {{4608, 3456}, 33331760L, 33331760L},
    {{4160, 3120}, 33331760L, 33331760L},
    {{4000, 3000}, 33331760L, 33331760L},
    {{3264, 2448}, 33331760L, 33331760L},
    {{2592, 1944}, 33331760L, 33331760L},
    {{1920, HEIGHT_2M}, 33331760L, 33331760L},
    {{1600, 1200}, 33331760L, 33331760L},
    {{1440, 1080}, 33331760L, 33331760L},
    {{1280, 720}, 33331760L, 33331760L},
    {{960, 720}, 33331760L, 33331760L},
    {{800, 600}, 33331760L, 33331760L},
    {{720, 480}, 33331760L, 33331760L},
    {{640, 480}, 33331760L, 33331760L},
    {{352, 288}, 33331760L, 33331760L},
    {{320, 240}, 33331760L, 33331760L}};
```

