Linux 网络设备驱动程序由 4 部分组成，分别是网络设备媒介层、网络设备驱动层、网络设备接口层及网络协议接口层。网络设备媒介层包括各种物理网络设备和传输媒介。对于网络设备接口层，Linux 系统用 Net_device 结构表示网络设备接口。Net_device 结构保存所有与硬件有关的接口信息，各协议软件主要通过 Net_device 结构来完成与硬件的交互。网络设备驱动层主要包括网络设备的初始化、数据包的发送和接收。网络协议接口层提供网络接口驱动程序的抽象接口。

Linux 网络驱动程序中的常用方法如下所示。

●　初始化（ initialize ）：检测设备；配置和初始化硬件；初始化 net_device 结构；注册设备。

●　打开（ open ）：这个方法在网络设备被激活的时候调用，进行资源的申请和硬件的激活等。open 方法的另一个作用是如果驱动程序作为一个模块被装入，则要防止模块卸载时设备处于打开状态。在 open 方法里要调用 MOD_INC_USE_COUNT 宏。

●　关闭（ close ）：释放某些系统资源。如果是作为模块装入的驱动程序，close 里应该调用 MOD_DEC_USE_COUNT，减少设备被引用的次数，以使驱动程序可以被卸载。

●　发送（ hard_start_xmit ）：网络设备驱动程序发送数据时，系统调用 dev_queue_xmit 函数，发送的数据放在一个 sk_buff 结构中。一般的驱动程序将数据传输到硬件发出去，特殊的设备如 loopback 把数据组成一个接收数据再回送给系统，或如 dummy 设备直接丢弃数据。如果发送成功，则在 hard_start_xmit 方法里释放sk_buff，返回 0，否则返回 1。

●　接收（ reception ）：驱动程序并不存在一个接收方法。有数据收到应该是驱动程序来通知系统的。一般设备收到数据后都会产生一个中断，在中断处理程序中驱动程序申请一块 sk_buff，从硬件读出数据放置到申请好的缓冲区里。接下来填充 sk_buff 中的一些信息。最后调用 netif_rx() 把数据传送给上层协议层处理。
