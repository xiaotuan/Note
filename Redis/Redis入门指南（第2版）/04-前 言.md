# 前 言

Redis如今已经成为Web开发社区中最火热的内存数据库之一，而它的诞生距现在不过才4年。随着Web 2.0的蓬勃发展，网站数据快速增长，对高性能读写的需求也越来越多，再加上半结构化的数据比重逐渐变大，人们对早已被铺天盖地地运用着的关系数据库能否适应现今的存储需求产生了疑问。而Redis的迅猛发展，为这个领域注入了全新的思维。

Redis凭借其全面的功能得到越来越多的公司的青睐，从初创企业到新浪微博这样拥有着几百台Redis服务器的大公司，都能看到Redis的身影。Redis也是一个名副其实的多面手，无论是存储、队列还是缓存系统，都有它的用武之地。

本书将从Redis的历史讲起，结合基础与实践，带领读者一步步进入Redis的世界。

## 第2版说明

在本书第1版截稿的时候，加入了Lua脚本功能的Redis 2.6版刚刚发布，此时的Redis正在逐渐地被国内的开发者所熟知。如今整整两年过去了，Redis也即将发布新的里程碑版本3.0版。在这两年中，Redis增加了许多优秀的功能，同时也被越来越多的公司所采用与信赖。在写这段文字时，恰好Redis的作者Salvatore Sanfilippo转述了别人的一句话：“如果把Redis官网的‘谁在使用Redis’页面改名为‘谁没在使用Redis’，那么这个页面的内容一定会精简不少。”虽然是一句玩笑话，但是也从侧面体现出这两年里Redis的飞速发展。而继续编写《Redis入门指南》第2版的最大动力也是希望将Redis发展的成果及时地与广大读者分享，同时也借此感谢大家对本书第1版的积极反馈。

## 目标读者

本书假定读者是Redis的新手，甚至可能连Redis是什么都没听说过。本书将会详细地介绍Redis是什么以及为什么要使用Redis，旨在能让读者从零开始逐步晋升为一个优秀的Redis开发者。

本书还包含了很多Redis实践方面的知识，对于有经验的Redis开发者，大可以直接跳过已经掌握的内容，只阅读感兴趣的部分。每章的引言都简要介绍了本章要讲解的内容，供读者参考。

本书并不需要读者有任何Redis的背景知识，不过如果读者有Web后端开发经验或Linux系统使用经验，阅读本书将会更加得心应手。

## 组织结构

第1章介绍了Redis的历史与特性，主要回答两个初学者最关心的问题，即Redis是什么和为什么要使用Redis。

第2章讲解了如何安装和运行Redis。如果你身旁的计算机没有运行Redis，那么一定不要错过这一章，因为本书后面的部分都需要读者最好能一边阅读一边实践，以提高学习效率。本章中还会介绍Redis命令行客户端的使用方法等基础知识，这些都是实践前需要掌握的知识。

第3章介绍了Redis的数据类型。本章讲解的不仅是每个数据类型的介绍和命令的格式，还会着重讲解每个数据类型分别在实践中如何使用。整个第3章会带领读者从零开始，一步步地使用Redis构建一个博客系统，旨在帮助读者在学习完本章的内容之后可以直接在自己的项目中上手实践Redis。

第4章引入了一些Redis的进阶知识，比如事务和消息系统等。同样本章还会继续以博客系统为例子，以实践驱动学习。

第5章介绍了如何在各个编程语言中使用Redis，这些语言包括PHP、Ruby、Python和Node.js。其中讲解每种语言时最后都会以一个有趣的例子作为演示，即使你不了解某些语言，阅读这些例子也能让你收获颇丰。

第6章展示了Redis脚本的强大功能。本章会向读者讲解如何借助脚本来扩展Redis，并且会对脚本一些需要注意的地方（如沙盒、随机结果等）进行着重介绍。

第7章会介绍Redis持久化的知识。Redis持久化包含RDB和AOF两种方式，对持久化的支持是Redis之所以可以用作数据库的必要条件。

第8章详细说明了多个Redis实例的维护方法，包括使用复制实现读写分离、借助哨兵来自动完成故障恢复以及通过集群来实现数据分片。

第9章介绍了Redis安全和协议相关的内容，并向会推荐几个第三方的Redis管理工具。

附录A收录了Redis命令的不同属性，以及属性的特征。

附录B收录了Redis部分配置参数的章节索引。

附录C收录了Redis使用的CRC16实现代码。

## 排版约定

本书排版使用字体遵从以下约定。

+ 等宽字：表示在命令行中输入的命令以及返回结果、程序代码、Redis的命令（包括命令语句和命令定义）。
+ 等宽斜体字（或夹在其中的中文楷体字）：表示命令或程序代码中由读者自行替换的参数或变量。
+ 等宽粗体字：表示命令行中用户的输入内容、伪代码中的Redis命令。
+ 命令行的输入和输出以如下格式显示：

```shell
$ redis-cli PING
PONG
```

+ Redis命令行客户端的输入和输出以如下格式显示：

```shell
redis> SET foo bar
OK
```

+ 程序代码以如下格式显示：

```shell
var redis = require("redis");
var client = redis.createClient();
// 将两个对象JSON序列化后存入数据库中
client.mset(
　　'user:1', JSON.stringify(bob),
　　'user:2', JSON.stringify(jeff)
);
```

## 代码约定

本书的部分章节采用了伪代码来讲解，这种伪代码类似Ruby和PHP，例如：

```shell
def hsetnx($key, $field, $value)
　　$isExists = HEXISTS $key, $field
　　if $isExists is 0
　　　　HSET $key, $field, $value
　　　　return 1
　　else
　　　　return 0
```

其中变量使用$符号标识，Redis命令使用的粗体表示并省略了括号以便于阅读。在命令调用和print等语句中没有$符号的字符串会被当作字符串字面值。

## 附加文件

本书第5章中每一节都包含了一个完整的程序，通常来讲，读者最好自己输入这些代码来加深理解，当然如果要先看到程序的运行结果再开始学习也不失为一个好办法。

这些程序代码都存放在GitHub上（https://github.com/luin/redis-book-assets），供读者查看和下载。读者也可以从异步社区（https://www.epubit.com）本书页面下载。

## 致谢

在本书写作的过程中，得到了很多朋友的帮助。请允许我在这里占用少许篇幅，向他们致以诚挚的谢意。

感谢人民邮电出版社的杨海玲老师对本书的支持，没有她的悉心指导，本书就无法顺利完成。

感谢刘亚晨、李欣越、寇祖阳和余尧，他们承担了许多额外的工作，使得我可以全身心地投入到写作中。

感谢所有浏览本书初稿并提出意见和建议的人们：张沈鹏、陈硕实、刘其帅、扈煊、李其超、朱冲宇、王诗吟、黄山月、刘昕、韩重远、李申申、杨海朝、田琪等。感谢你们的支持。

另外还要感谢“宋老师”，是的，就是书中的主人公之一。几年前，我刚创业时，办公场所是和某教育机构合租的，宋老师是该机构的一名英语老师，同时他也是国内一个知名的嘻哈乐团成员之一。他平日风趣的谈吐带给了我们很多欢乐，伴随我们走过了艰苦的创业初期，而我接触Redis，也正是从这段时间开始的。

最后，感谢我的父母和女朋友马梦妍，你们是我生命中最重要的人，感谢你们的理解和支持。



