### 40.1　utmp和wtmp文件概述

UNIX系统维护着两个包含与用户登录和登出系统有关的信息的数据文件。

+ utmp文件维护着当前登录进系统的用户记录（以及其他一些信息，稍后将会介绍）。每一个用户登录进系统时都会向 utmp 文件写入一条记录。在这条记录中包含一个ut_user 字段，它记录着用户的登录名。当用户登出的时候该条记录会被删除。像who(1)之类的程序会使用 utmp 文件中的信息来显示当前登录进系统的用户列表。
+ wtmp文件包含着所有用户登录和登出行为的留痕信息以供审计之用（以及其他一些信息，稍后将会介绍）。每一个用户登录进系统时，写入utmp文件中的记录同时会被附加到wtmp文件中。当用户登出系统的时候还会向这个文件附加一条记录。这条记录包含的信息与登录记录相同，但ut_user字段会被置零。last(1)命令可以用来显示和过滤wtmp文件中的内容。

在Linux上，utmp文件位于/var/run/utmp，wtmp文件位于/var/log/wtmp。一般来讲，应用程序无需知道这些路径名，因为这些路径名是编译进glibc的。需要引用这些文件的存储位置的程序应该使用在<paths.h> (and <utmpx.h>)中定义的_PATH_UTMP和_PATH_WTM路径名常量，而不是在代码中硬编码路径名。

> SUSv3并没有为utmp和wtmp文件的路径名提供标准化的符号名。Linux和BSD使用了_PATH_UTMP和_PATH_WTMP。而其他很多UNIX实现定义了UTMP_FILE和WTMP_FILE常量来表示这两个路径名。Linux还在<utmp.h>中定义了这些名词，但并没有在<utmpx.h>和<paths.h>中对它们进行定义。

