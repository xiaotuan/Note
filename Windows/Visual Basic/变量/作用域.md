[toc]

对于常量或变量，作用域可以是以下几种之一：

+ 块级；
+ 过程级（局部）；
+ 模块级；
+ 全局（也被称为命名空间级）。

### 1. 块级作用域

块级作用域也称为结构作用域，是 Visual Basic.NET 新增的。Visual Basic 检查变量是否是在结构中声明的，如果是，变量的作用域便是块。

结构是由两条语句而不是一条语句组成的编码结构。例如 `If...Then` 结构：

```vb
If expression Then
    statements to execute when expression is True
End If
```

如果变量是在结构中声明的，则其作用域被限定在该结构内，该变量在遇到相应的 Dim 语句后才被创建，在结构结束处被销毁。

### 2. 过程级（局部）作用域

在过程内部声明常量或变量时，常量或变量的作用域便是过程级或局部的。创建的大多数变量的作用域都是过程级的。

### 3. 模块级作用域

当常量或变量的作用域为模块级时，它对包含该变量声明的模块中所有的过程都是可见的。然而，对于其他所有模块中的过程，这个常量或变量是不存在的。要创建作用域为模块级的常量或变量，必须将声明放在模块中而不是过程中。声明区域位于每个模块的开头。

> 注意：虽然使用 `Dim` 声明的模块级变量是模块私有的，但最好使用关键字 `Private` 来声明私有的模块级变量。

> 提示：一种快速进入模块声明区域的方法是，在模块窗口右上角的过程下拉列表中选择 "（声明）"。

### 4. 全局（命名空间级）作用域

可在任何过程（无论该过程位于哪个模块中）中看到和引用的常量或变量的作用域为全局（命名空间级）。

要声明全局常量，以关键字 `Public` 打头，如下所示：

```vb
Public Const MyConstant As Integer = 1
```

要声明全局变量，使用关键字 `Public` 替代关键字 `Dim` 或 `Private`，如下所示：

```vb
Public strMyVariable as String
```

要创建全局变量或常量，必须在标准模块（而不是基于类的模块）中声明它们。如果在类模块中声明一个公有变量或常量，其行为将类似于类的属性。

### 5. Friend 作用域

使用 `Friend` 声明的变量或过程的作用域为在整个项目中是全局的，但对于通过自动化类访问代码的应用程序来说不可见。