[toc]

### 1. 按值传递参数

按值传递使用 `ByVal` 关键字定义参数。使用时，程序为形参在内存中临时分配一个内存单元，并将实参的值传递到这个内存单元中。当过程中改变形参的值时，只是改变形参内存单元中的值，实参的值不会改变。例如：

```vb
Private Sub test(ByVal a As Integer, ByVal b As Integer)
    a = a + 20 : b = b + 10
    Debug.Print("a = " & a & ", b = " & b)
End Sub
```

### 2. 按地址传递参数

按地址传递使用 `ByRef` 关键字定义的参数。在定义过程时，如果没有 `ByVal` 关键字，默认是按地址传递参数。

所谓按地址传递参数，就是把形参变量的内存地址传递给被调用的过程。形参和实参具有相同的地址，即形参和实参共享同一段存储单元。例如：

```vb
Private Sub test(a As Integer, b As Integer)
    a = a + 20 : b = b + 10
    Debug.Print("a = " & a & ", b = " & b)
End Sub
```

### 3. 使用按地址或按值传递参数的规则

（1）对于整型、长整型或单精度参数，如果不希望过程修改实参的值，则采用传值方式；而为了提高效率，字符串和数组应采用传地址方式。此外，用户定义的类型和控件只能通过地址传送。

（2）对于其他数据类型，可以采用两种方式传送。但是，对于此类参数，建议最好用传值方式传送，这样可以避免错用参数。

函数过程可以通过过程名返回值，但只能返回一个值；子过程不能通过过程名返回值，但可以通过参数返回值，并可以返回多个值。当需要子过程返回值时，其相应的参数要用传地址方式。