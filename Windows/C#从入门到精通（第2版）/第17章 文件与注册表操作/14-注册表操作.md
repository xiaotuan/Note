### 17.4　注册表操作

<img src="https://cdn.ptpress.cn/pubcloud/5B0A982E/ushu/N19937/online/FBOL6c69757cf0cda/Images/7.png" style="width:64px;  height: 63px; " width="6%" class="my_markdown"/>
**本节视频教学录像：7分钟**

注册表编辑器对Windows操作系统来说是非常重要的，也是病毒常常会“光顾”的地方，比如病毒和恶意软件常常会在注册表的启动项里面写入自己的启动键值来达到自启动的目的，有些病毒还会通过修改注册表来映像劫持杀毒软件，这是破坏系统的第一步。同时，大多软件（软件的序列号和信息）和硬件信息、系统信息、安全模式等设置都保存在这里，因此系统的健康在很大程度上要依赖于注册表的健康。

作为编程开发人员，我们有必要了解注册表并学会操作注册表。我们都知道，只要在Windows操作系统中的“运行”里面输入“regedit”，就可以打开注册表编辑器了。注册表编辑器是树形目录结构，共有5个根目录，称为子树，子树下依次为项、子项和活动子项，活动子项对应右栏中的键，键包括3部分：名称、数据类型、值。

注册表项是注册表中的基本组织单位，每个具体的注册表项都可以有子项。只要用户具有相应的权限，且注册表项不是基项或基项的下一级项，就可以删除该注册表项。每个注册表项也可带有与其相关联的多个值（一个值就好比是一个文件），它们用于存储信息。例如，可以为每个应用程序创建一个子项，每个子项下的键保存特定于该应用程序的信息，如颜色设置、屏幕位置和大小或者可识别的文件扩展名等。

下面我们就来用.NET下的托管语言C#操作注册表，主要内容包括注册表项的创建、打开与删除，键值的创建(设置值、修改)、读取和删除，判断注册表项是否存在，判断键值是否存在。要操作注册表，我们必须引入必要的命名空间Microsoft.Win32。Microsoft.Win32命名空间里面提供的RegistryKey 类可用来操作注册表。

