### 9.6　项目：创建可更新的多重剪贴板

让我们重写第6章中的“多重剪贴板”程序，让它使用 `shelve` 模块。用户现在可以保存新字符串，以便加载到剪贴板，而无须修改源代码。我们将这个新程序命名为mcb.pyw（因为输入“mcb”比“multi-clipboard”更短）。.pyw扩展名意味着Python在运行该程序时不会显示命令行窗口。（更多详细信息请参见附录B。）

该程序将利用一个关键字保存每段剪贴板文本。例如，当运行 `py mcb.pyw save spam时` ，剪贴板中当前的内容就用关键字 `spam` 保存。运行 `py mcb.pyw spam` ，这段文本稍后将重新加载到剪贴板中。如果用户忘记了都有哪些关键字，可以运行 `py mcb.pyw list` ，将所有关键字的列表复制到剪贴板中。

程序需要完成以下任务。

1．针对要检查的关键字来提供命令行参数。

2．如果参数是 `save` ，那么将剪贴板的内容保存到关键字。

3．如果参数是 `list` ，就将所有的关键字复制到剪贴板。

4．否则，就将关键字对应的文本复制到剪贴板。

这意味着代码需要执行以下操作。

1．从 `sys.argv` 读取命令行参数。

2．读写剪贴板。

3．保存并加载 `shelf` 文件。

如果你使用Windows操作系统，那么可以创建一个名为mcb.bat的批处理文件，通过“Run…”窗口运行这个脚本很容易。该批处理文件包含如下内容：

```javascript
@pyw.exe C:\Python34\mcb.pyw %*
```

