[toc]

### 1. sizeof 运算符和 size_t 类型

`sizeof` 运算符以字节为单位返回运算对象的大小，运算对象可以是具体的数据对象或类型。如果运算对象是类型，则必须用圆括号将其括起来。

**程序清单 5.8 sizeof.c 程序**

```c
// sizeof.c -- 使用 sizeof 运算符
// 使用 C99 新增的 %zd 转换说明 -- 如果编译器不支持 %zd，请将其改成 %u 或 %lu 
#include <stdio.h>

int main(void)
{
	int n = 0;
	
	size_t intsize;

	intsize = sizeof (int);
	printf("n = %d, n has %zd bytes; all ints have %zd bytes.\n", n, sizeof n, intsize);

	return 0;
}
```

输出结果如下：

```console
n = 0, n has 4 bytes; all ints have 4 bytes.
```

C 语言规定，`sizeof` 返回 `size_t` 类型的值。

C 有一个 `typedef` 机制，允许程序员为现有类型创建别名。例如：

```c
typedef double real;
```

### 2. 求模运算符：%

求模运算符用于整数运算。求模运算符给出其左侧整数除以右侧整数的余数。求模运算符只能用于整数，不能用于浮点数。

**程序清单 5.9 min_sec.c 程序**

```c
// min_sec.c -- 把秒数转换成分和秒
#include <stdio.h>
#define SEC_PER_MIN 60	// 1 分钟 60秒

int main(void)
{
	int sec, min, left;

	printf("Convert seconds to minutes and seconds!\n");
	printf("Enter the number of seconds (<=0 to quit): \n");
	scanf("%d", &sec);	// 读取秒数
	while (sec > 0)
	{
		min = sec / SEC_PER_MIN;	// 截断分钟数
		left = sec % SEC_PER_MIN;	// 剩下的秒数
		printf("%d seconds is %d minutes, %d seconds.\n", sec, min, left);
		printf("Enter next value (<=0 to quit):\n");
		scanf("%d", &sec);
	}
	printf("Done!\n");

	return 0;
}
```

输出结果如下：

```console
Convert seconds to minutes and seconds!
Enter the number of seconds (<=0 to quit): 
154
154 seconds is 2 minutes, 34 seconds.
Enter next value (<=0 to quit):
567
567 seconds is 9 minutes, 27 seconds.
Enter next value (<=0 to quit):
0
Done!
```

C99 规定 "趋零截断" 之前，负数求模问题的处理方法很多。但自从有了这条规则之后，如果第 1 个运算对象是负数，那么求模的结果为负数；如果第 1 个运算对象是正数，那么求模的结果也是正数。

如果当前系统不支持 C99 标准，则无论何种情况，只要 a  和 b 都是整数值，便可通过 a - (a / b) * b 来计算 a % b。例如， 可以这样计算 -11 % 5:

```console
-11 - (-11 / 5) * 5 = -11 - (-2) * 5 = -11 - (-10) =-1
```

### 3. 递增运算符：++

递增运算符执行简单的任务，将其运算对象递增 1。该运算符以两种方式出现。第 1 种方式，++ 出现在其作用的变量前面，这是前缀模式；第 2 种方式，++ 出现在其作用的变量后面，这是后缀模式。

**程序清单 5-10 add_one.c 程序**

```c
/* add_one.c -- 递增：前缀和后缀 */
#include <stdio.h>
int main(void)
{
	int ultra = 0, super = 0;

	while (super < 5) {
		super++;
		++ultra;
		printf("super = %d, ultra = %d \n", super, ultra);
	}

	return 0;
}
```

输出结果如下：

```console
super = 1, ultra = 1
super = 2, ultra = 2
super = 3, ultra = 3
super = 4, ultra = 4
super = 5, ultra = 5
```

**程序清单 5.11 post_pre.c 程序**

```c
/* post_pre.c -- 前缀和后缀 */
#include <stdio.h>

int main(void)
{
	int a = 1, b = 1;
	int a_post, pre_b;

	a_post = a++;	// 后缀递增
	pre_b = ++b;	// 前缀递增
	printf("a   a_post   b   pre_b \n");
	printf("%1d %5d %5d %5d\n", a, a_post, b, pre_b);

	return 0;
}
```

输出结果如下：

```console
a   a_post   b   pre_b
2     1     2     2
```

### 4. 递减运算符：--

**程序清单 5.12 bottles.c 程序**

```c
#include <stdio.h>

#define MAX 100

int main(void)
{
	int count = MAX + 1;

	while (--count > 0)
	{
		printf("%d bottles of spring water on the wall, "
			"%d bottles of spring water!\n", count, count);
		printf("Take one down and pass it around,\n");
		printf("%d bottles of spring water!\n\n", count - 1);
	}
	
	return 0;
}
```

输出结果如下：

```console
100 bottles of spring water on the wall, 100 bottles of spring water!
Take one down and pass it around,
99 bottles of spring water!

99 bottles of spring water on the wall, 99 bottles of spring water!
Take one down and pass it around,
98 bottles of spring water!

98 bottles of spring water on the wall, 98 bottles of spring water!
Take one down and pass it around,
97 bottles of spring water!

......
```

### 5. 优先级

递增运算符和递减运算符都有很高的结合优先级，只有圆括号的优先级比它们高。

### 6. 不要自作聪明

使用递增或递减应遵循以下规则：

+ 如果一个变量出现在一个函数的多个参数中，不要对该变量使用递增或递减运算符
+ 如果一个变量多次出现在一个表达式中，不要对该变量使用递增或递减运算符。