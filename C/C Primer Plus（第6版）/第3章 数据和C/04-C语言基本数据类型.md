[toc]

### 1. int 类型

#### 1.1 声明 int 变量

先写上 int，然后写变量名，最后加上一个分号。要声明多个变量，可以单独声明每个变量，也可以在 int 后面列出多个变量名，变量名之间用逗号分隔。下面都是有效的声明：

```c
int erns;
int hogs, cows, goats;
```

#### 1.2 初始化变量

初始化可以直接在声明中完成。只需在变量名后面加上赋值运算符（=）和待赋给变量的值即可。如下所示：

```c
int hogs = 21;
int cows = 32, goats = 14;
int dogs, cats = 94;	/* 有效，但是这种格式很糟糕 */
```

#### 1.3 int类型常量

C 语言把不含小数点和指数的数作为整数。C语言把大多数整型常量视为 int 类型，但非常大的整数除外。

#### 1.4 打印 int 值

可以使用 printf() 函数打印 int 类型的值，%d 指明了在一行中打印整数的位置。

程序清单 **3.2 print1.c** 程序

```c
/* print1.c - 演示 printf() 的一些特性 */
#include <stdio.h>
int main(void)
{
	int ten = 10;
	int two = 2;
	printf("Doing it right: ");
	printf("%d minus %d is %d\n", ten, 2, ten - two);
	printf("Doing it wrong: ");
	printf("%d minus %dis %d\n", ten);	// 遗漏 2 个参数
	return 0;
}
```

编译并运行该程序，输出如下：

```console
Doing it right: 10 minus 2 is 8
Doing it wrong: 10 minus 9507641is 9507641
```

#### 1.5 八进制和十六机制

在 C 语言中，用特定的前缀表示使用哪种进制。0x 或 0X 前缀表示十六进制。0 前缀表示八进制。

#### 1.6 显示八进制和十六进制

以十进制显示数字，使用 %d；以八进制显示数字，使用 %o；以十六机制显示数字，使用 %X。另外，要显示各进制的前缀 0、0x 和 0X，必须分别使用 %#o、%#x、%#X。

程序清单 **3.3 bases.c** 程序

```c
/* bases.c -- 以十进制、八进制、十六进制打印十进制数 100 */
#include <stdio.h>
int main(void)
{
	int x = 100;
	printf("dec = %d; octal = %o; hex = %x\n", x, x, x);
	printf("dec = %d; octal = %#o; hex = %#x\n", x, x, x);
	return 0;
}
```

编译并运行该程序，输出如下：

```console
dec = 100; octal = 144; hex = 64
dec = 100; octal = 0144; hex = 0x64
```

### 2. 其他整数类型

#### 2.1 声明其他整数类型

```c
long int estine;
long johns;
short int erns;
short ribs;
unsigned in s_count;
unsigned players;
unsigned players;
unsigned long headcount;
unsigned short yesvotes;
long long ago;
```

#### 2.2 long 常量和 long long 常量

通常，程序代码中使用的数字都被存储为 int 类型。超出了 int 类型能表示的范围，编译器会将其视为 long int 类型。如果数字超出了 long 可表示的最大值，编译器则将其视为 unsigned long 类型。如果还不够大，编译器则将其视为 long long 或 unsigned long long 类型。

在支持 long long 类型的系统中，也可以使用 ll 或 LL 后缀来表示 long long 类型的值。另外，u 或 U 后缀表示 unsigned long long，如 5ull、10LLU。

**整数溢出**

```c
/* toobig.c -- 超出系统允许的最大 int 值 */
#include <stdio.h>
int main(void)
{
	int i = 2147483647;
	unsigned int j = 4294967295;
	printf("%d %d %d\n", i, i + 1, i + 2);
	printf("%u %u %u\n", j, j + 1, j + 2);
	return 0;
}
```

在我们的系统下输出的结果是：

```console
2147483647 -2147483648 -2147483647
4294967295 0 1
```

#### 2.3 打印 short、long、long long 和 unsigned 类型

打印 unsigned int 类型的值，使用 %u 转换说明；打印 long 类型的值，使用 %ld 转换说明。在 x 和 o 前面可以使用 l 前缀，%lx 表示以十六进制格式打印 long 类型的整数， %lo 表示以八进制格式打印 long 类型整数。

对于 short 类型，可以使用 h 前缀。%hd 表示以十进制显示 short 类型的整数， %ho 表示以八进制显示 short 类型的整数。h 和 l 前缀都可以和 u 一起使用，用于表示无符号类型。

程序清单 **3.4 print2.c** 程序

```c
/* print2.c -- 更多 printf() 的特性 */
#include <stdio.h>
int main(void)
{
	unsigned int un = 3000000000;	/* int 为 32 位和 short 为 16 位的系统 */
	short end = 200;
	long big = 65537;
	long long verybig = 12345678908642;
	printf("un = %u and not %d\n", un, un);
	printf("end= %hd an %d\n", end, end);
	printf("big = %ld and not %hd\n", big, big);
	printf("verybig = %lld and not %ld\n", verybig, verybig);
	return 0;
}
```

在特定的系统中输出如下：

```console
un = 3000000000 and not -1294967296
end= 200 an 200
big = 65537 and not 1
verybig = 12345678908642 and not 1942899938
```

### 3. 使用字符： char 类型

char 类型用于存储字符，但是从技术层面看，char 是整数类型。C 语言把 1 字节定义为 char 类型占用的位（big）数，因此无论是 16 位还是 32 位系统，都可以使用 char 类型。

#### 3.1 声明 char 类型变量

char 类型变量的声明方式与其他类型变量的声明方式相同。下面是一些例子：

```c
char response;
char itable, latan;
```

#### 3.2 字符常量和初始化

通过以下初始化把字母 A 赋给 grade 即可：

```c
char grade = 'A';
```

在 C 语言中，用单引号括起来的单个字符被称为字符常量。

实际上，字符是以数值形式存储的，所以也可以使用数字代码值来赋值：

```c
char grade = 65;	/* 对于 ASCII，这样做没问题，但这是一种不好的编程风格 */
```

#### 3.3 非打印字符

<center>表3.2 转义序列</center>

| 转义序列 | 含义                                                         |
| -------- | ------------------------------------------------------------ |
| \a       | 警报（ANSIC）                                                |
| \b       | 退格                                                         |
| \f       | 换页                                                         |
| \n       | 换行                                                         |
| \r       | 回车                                                         |
| \t       | 水平制表符                                                   |
| \v       | 垂直制表符                                                   |
| \\\\     | 反斜杠（\）                                                  |
| \\'      | 单引号                                                       |
| \\"      | 双引号                                                       |
| \?       | 问号                                                         |
| \0oo     | 八进制（oo必须是有效的八进制数，即每个 o 可表示 0 ~ 7 中的一个数） |
| \xhh     | 十六进制（hh必须是有效的十六机制数，即每个 h 可表示 0 ~ f 中的一个数） |

#### 3.4 打印字符

printf() 函数用 %c 指明待打印的字符。

程序清单 **3.5 charcode.c** 程序

```c
/* charcode.c -- 显示字符的代码编号 */
#include <stdio.h>
int main(void)
{
	char ch;
	printf("Please enter a character.\n");
	scanf("%c", &ch);	/* 用户输入字符 */
	printf("The code for %c is %d.\n", ch, ch);
	return 0;
}
```

运行该程序后，输出示例如下：

```console
Please enter a character.
C
The code for C is 67.
```

#### 3.5 有符号还是无符号

有些 C 编译器把 char 实现为有符号类型，这意味着 char 可表示的范围是 -128 ~ 127。而有些 C 编译器把 char 实现为无符号类型，那么 char 可表示的范围是 0 ~255，具体可以查阅 limits.h 头文件。

根据 C90 标准，C 语言允许在关键字 char 前面使用 signed 或unsigned。这样，无论编译器默认 char 是什么类型，signed char 表示有符号类型，而 unsigned char 表示无符号类型。

### 4. _Bool 类型

C99 标准添加了 _Bool 类型，用于表示布尔值，即逻辑值 true 和 false。因为 C 语言用值 1 表示 true，值 0 表示 false，所以 _Bool 类型实际上也是一种整数类型。但原则上它仅占用 1 位存储空间。

### 5.  可移植类型：stdint.h 和 inttypes.h

C99 新增了两个头文件 stdint.h 和 inttypes.h，以确保 C 语言的类型在各系统中的功能相同。

C99 和 C11 不仅提供可移植的类型名，还提供相应的输入和输出。inttypes.h 头文件中定义了 PRId32 字符串宏，代表打印 32 位有符号值的合适转换说明。

程序清单 **3.6 altnames.c** 程序

```c
/* altnames.c -- 可移植整数类型名 */
#include <stdio.h>
#include <inttypes.h>	// 支持可移植类型

int main(void)
{
	int32_t me32;	// me32 是一个 32 为有符号整型变量
	me32 = 45933945;
	printf("First, assume int32_t is int: ");
	printf("me32 = %d\n", me32);
	printf("Next, let's not make any assumptions.\n");
	printf("Instead, use a \"macro\" from inttypes.h: ");
	printf("me32 = %" PRId32 "\n", me32);
}
```

下面是该程序的输出，注意，程序中使用了 \\" 转义序列来显示双引号：

```console
First, assume int32_t is int: me32 = 45933945
Next, let's not make any assumptions.
Instead, use a "macro" from inttypes.h: me32 = 45933945
```

### 6. float、double 和 long double

C 标准规定，float 类型必须至少能表示 6 位有效数字，且取值范围至少是 10<sup>-37</sup> ~ 10<sup>+37</sup>。前一项指 float 类型必须至少精确表示小数点后的 6 位有效数字。通常，系统存储一个浮点数要占用 32 位。其中 8 位用于表示指数的值和符号，剩下 24 位用于表示非指数部分及其符号。

C 语言提供的另一种浮点类型是 double。double 类型和 float 类型的最小取值范围相同，但至少必须能表示 10 位有效数字。一般情况下，double 占用 64 位而不是 32 位。

#### 6.1 声明浮点型变量

下面是一些例子：

```c
float noah, jonah;
double trouble;
float planck = 6.63e-34;
long double gnp;
```

#### 6.2 浮点型常量

浮点型常量的基本形式是：有符号的数字（包括小数点），后面紧跟 e 或 E，最后是一个有符号数表示 10 的指数。下面是两个有效的浮点型常量：

```c
-1.56E+12
2.87e-3
```

正号可以省略。可以没有小数点（如， 2E5）或指数部分（如，19.28），但是不能同时省略两者。可以省略小数部分（如，3.E16）或整数部分（如，。45E-6），但是不能同时省略两者。不要在浮点型常量中间加空格：1.56 E+12（错误！）。默认情况下，编译器假定浮点型常量是 double 类型的精度。

在浮点数后面加上 f 或 F 后缀可覆盖默认设置，编译器会将浮点型常量看作 float 类型，如 2.3f 和 9.11E9F。

C99 标准添加了一种新的浮点型常量格式 —— 用十六进制数前加上十六进制前缀（0x 或 0X），用 p 和 P 分别代替 e 和 E，用 2 的幂代替 10 的幂（即，p 计数法）。如下所示：

```console
0xa.1fp10
```

#### 6.3 打印浮点数

printf() 函数使用 %f 转换说明打印十进制记数法的 float 和 double 类型浮点数，用 %e 打印指数记数法的浮点数。如果系统支持十六进制格式的浮点数，可用 a  和 A 分别代替 e 和 E。打印 long double 类型要使用 %Lf、%Le 或 %La 转换说明。

程序清单 **3.7 showf_pt.c** 程序

```c
/* showf_pt.c -- 以两种方式显示 float 类型的值 */
#include <stdio.h>
int main(void)
{
	float aboat = 32000.0;
	double abet = 2.14e9;
	long double dip = 5.32e-5;
	printf("%f can be written %e\n", aboat, aboat);
	// 下一行要求编译器支持 C99 或其中的相关特性
	printf("And it's %a in hexadecimal, powers of 2 notation\n", aboat);
	printf("%f can be written %e\n", abet, abet);
	printf("%Lf can be written %Le\n", dip, dip);
	return 0;
}
```

该程序的输出如下，前提是编译器支持 C99/C11：

```console
32000.000000 can be written 3.200000e+04
And it's 0x1.f400000000000p+14 in hexadecimal, powers of 2 notation
2140000000.000000 can be written 2.140000e+09
0.000053 can be written 5.320000e-05
```

#### 6.4 浮点值的上溢和下溢

当计算导致数字过大，超过当前类型能表达的范围时，就会发生上溢。这种行为在过去是未定义的，不过现在 C 语言规定，在这种情况下会给 toobig 赋一个表示无穷大的特定值，而且 printf() 显示该值为 inf 或 infinity。

下溢，C 语言把损失了类型全精度的浮点值称为低于正常的 浮点值。因此，把最小的正浮点数除以 2 将得到一个低于正常的值。如果除以一个非常大的值，会导致所有的位都为 0。现在，C 库已提供了用于检查计算是否会产生低于正常值的函数。

还有另一个特殊的浮点值 NaN （not a number 的缩写）。例如，给 asin() 函数传递一个值，该函数将返回一个角度，该角度的正弦就是传入函数的值。但是正弦值不能大于 1，因此，如果传入的参数大于 1，该函数的行为是未定义的。在这种情况下，该函数将返回 NaN 值，printf() 函数可将其显示为 nan、NaN 或其他类似的内容。

**浮点数舍入错误**

```c
/* floaterr.c -- 演示舍入错误 */
#include <stdio.h>

int main(void)
{
	float a, b;
	b = 2.0e20 + 1.0;
	a = b - 2.0e20;
	printf("%f \n", a);
	return 0;
}
```

该程序的输出如下：

```console
0.000000	           <- Linux 系统下的老式 gcc
-13584010575872.000000 <- Turbo C 1.5
4008175468544.000000   <- XCode 4.5、Visual Studio 2012、当前版本的 gcc
```

### 7. 复数和虚数类型

C 语言有 3 种复数类型：float  _Complex、double  _Complex 和 long double _Complex（实际类型名称不是这样的，具体请看 complex.h 头文件）。类似地，C 语言的 3 中虚数类型是 float _Imaginary、double _Imaginary 和 long double _Imaginary。

### 8. 类型大小

如何知道当前系统的指定类型的大小是多少？

程序清单 **3.8 typesize.c** 程序

```c
/* typesize.c -- 打印类型大小 */
#include <stdio.h>

int main(void)
{
	/* C99 为类型大小提供 %zd 转换说明 */
	printf("Type int has a size of %zd bytes.\n", sizeof(int));
	printf("Type char has a size of %zd bytes.\n", sizeof(char));
	printf("Type long has a size of %zd bytes.\n", sizeof(long));
	printf("Type long long has a size of %zd bytes.\n", 
		sizeof(long long));
	printf("Type double has a size of %zd bytes.\n", 
		sizeof(double));
	printf("Type long double has a size of %zd bytes.\n", 
		sizeof(long double));
	return 0;
}
```

该程序的输出如下：

```console
Type int has a size of 4 bytes.
Type char has a size of 1 bytes.
Type long has a size of 4 bytes.
Type long long has a size of 8 bytes.
Type double has a size of 8 bytes.
Type long double has a size of 8 bytes.
```

> 一些不支持 C99 和 C11 的编译器可用 %u 或 %lu 代替 %zd。

> 注意：该程序最后几行，printf() 语句都被分为两行，只要不在引号内部或一个单词中间断行，就可以这样写。

