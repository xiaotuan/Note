**Bug**

系统升级》焦点在启动升级，遥控器按下，焦点移到了网络信息

**重现步骤**

[步骤]

硬件型号：CM201-2
版本号：100.462.006（统一）
1、设置-系统升级
2、进入升级页面，焦点移到启动升级按钮
3、遥控器按【下】

[结果]
结果：焦点移到了网络信息
现网对比结果：同此问题

[备注] CM201-1版本存在同样的问题

**问题分析**

升级按钮未对 Down 焦点进行处理，而是交由系统处理导致的。

**解决办法**

修改布局文件 upgrade.xml 文件，对 ID 为 crb_upgrade_now 的按钮添加对 Down 焦点的处理。具体修改如下：

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:sw="http://schemas.android.com/apk/res/net.sunniwell.app.swsettings"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/trans"
    android:orientation="vertical" >

    ......

    <LinearLayout
        android:id="@+id/frameupgrade_show_upgrade_enforce"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:visibility="visible" >

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="@dimen/d_10dp" >

            <ProgressBar
                android:id="@+id/progressbarhttp"
                style="@style/systemup_pb_style"
                android:layout_width="@dimen/d_500dp"
                android:layout_height="wrap_content"
                android:layout_centerVertical="true"
                android:layout_marginLeft="@dimen/d_50dp"
                android:layout_marginRight="@dimen/d_100dp"
                android:clickable="false"
                android:max="100"
                android:visibility="gone" />

            <Button
                android:id="@+id/crb_upgrade_now"
                style="@style/button"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_centerVertical="true"
                android:layout_marginRight="@dimen/d_15dp"
                android:nextFocusLeft="@+id/leftMenu_layout"
                android:padding="@dimen/d_10dp"
                android:text="@string/upgrade_check" />
        </RelativeLayout>

        <include layout="@layout/divider" />
    </LinearLayout>
	
	......

</LinearLayout>

```

由于进入该界面后，升级按钮并未获取焦点，导致在在遥控器上导航时，其实是对菜单列表进行导航。解决这个问题的办法是在进入该界面后给升级按钮获取焦点。修改 FrameUpgrade.java 文件如下：

```java
public class FrameUpgrade extends SWPager {
	......
        
	private Button mBt_save, mBt_check, mBt_saveTime, mBt_upgrade_usb, mBt_upgrade_local;
    
    ......

	/**
	 * 根据配置文件，需要展示哪些view
	 */
	private void showParamsView() {
		try {
			mParams = mSWPageManager.getParams();
			if (mParams == null) {
				return;
			}

			for (String param : mParams) {
				if (param.contains("upgradeServer0")) {
					mLayout_show_upgrade_first_server.setVisibility(View.GONE);
				}

				if (param.contains("upgradeServerEditFocus0")) {
					mEt_url.setFocusable(false);
					mEt_url.setVisibility(View.GONE);
					mTxtUrl.setVisibility(View.VISIBLE);
				} else {
					mEt_url.setVisibility(View.VISIBLE);
					mTxtUrl.setVisibility(View.GONE);
				}

				if (param.contains("enforceUpgrade0")) {
					mLayout_show_upgrade_upgrade_enforce.setVisibility(View.GONE);
				} else {
                    mBt_check.requestFocus();
                }

				if (param.contains("silentUpgrade0")) {
					mLayout_show_upgrade_upgrade_silent.setVisibility(View.GONE);
				}
				if (param.contains("forciblyUpgrade0")) {
					mLayout_show_upgrade_upgrade_forcibly.setVisibility(View.GONE);
				}

				if (param.contains("upgradeTime0")) {
					mLayout_show_upgrade_time_check.setVisibility(View.GONE);
				}

				if (param.contains("upgradeUsb0")) {
					mLayout_show_upgrade_usb.setVisibility(View.GONE);
				}
				if (param.contains("upgradeTms0")) {
					mLayout_show_upgrade_local.setVisibility(View.GONE);
				}
				if (param.contains("focuse_bj")) {
					mBt_upgrade_usb.setNextFocusUpId(mBt_upgrade_usb.getId());
					// mBt_upgrade_usb.setNextFocusDownId(mBt_upgrade_usb.getId());
				}
				if (param.contains("focuse_sd")) {
					mBt_check.setNextFocusUpId(mBt_check.getId());
				}
			}
		} catch (Exception e) {
			e.printStackTrace();
		}

	}

    ......

}
```

